<!DOCTYPE html>
<html lang='zh'>
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">
<title>
  
     selenium入门使用 |  Sweet House
  
</title>


  <meta name="description" content="Everyday is a holiday">


<meta name="bytedance-verification-code" content="MmXZwSvr8lAvM1hIXSkm" />

<meta name="author" content='[Ryuchen WangOO]'>

<link rel="icon" href='/favicon.ico'>


  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/themes/prism-dark.min.css">
  



  
      
        <link rel="stylesheet" href='/dist/main.4707e15c5ca4eab5da71.min.css'>
      
  


<link rel="stylesheet" href='/css/shortcodes.css'>

<link rel="canonical" href="https://ryuchen.club/posts/0x000014/"><meta property="og:title" content="selenium入门使用" />
<meta property="og:description" content="这是一个系列内容，最近女友在跟我学习Python编程，然后就开了这个爬虫系列，主要也是借此机会将自己所会的爬虫相关的知识进行梳理并同时做好备课工作~~【如果这个系列对你有帮助的话，请在这个博客下面留言，我会尽可能做好思路梳理】" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ryuchen.club/posts/0x000014/" />
<meta property="og:image" content="https://ryuchen.club/spider-requests.jpg" />
<meta property="article:published_time" content="2020-04-08T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-04-08T00:00:00+00:00" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000015/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000013/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000011/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000012/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000010/" />

<meta itemprop="name" content="selenium入门使用">
<meta itemprop="description" content="这是一个系列内容，最近女友在跟我学习Python编程，然后就开了这个爬虫系列，主要也是借此机会将自己所会的爬虫相关的知识进行梳理并同时做好备课工作~~【如果这个系列对你有帮助的话，请在这个博客下面留言，我会尽可能做好思路梳理】">
<meta itemprop="datePublished" content="2020-04-08T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-04-08T00:00:00+00:00" />
<meta itemprop="wordCount" content="463">
<meta itemprop="image" content="https://ryuchen.club/spider-requests.jpg">



<meta itemprop="keywords" content="spider,requests,爬虫," />

    </head>
    <body>
        
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://ryuchen.club"> >$ cd /home_</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-menu">
            <ul class="navbar-nav ml-auto">
                    
                        <li class='nav-item'><a class="nav-link" href="/">首页</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/posts/">博文</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/projects/">项目</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/snippet/">代码</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/essay/">随笔</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/gallery/">照片墙</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/about/">关于</a></li>
                    
                
                <li class="nav-item"><a class="nav-link" href="https://github.com/Ryuchen" target="_blank">Github</a></li>
            </ul>
        </div>
    </div>
</nav>

        
<main class="content-page container pt-7 pb-5">
    
    <div class="row">
        <div class="col">
            <article>
                <div class="row justify-content-center">
                    <div class="col-lg-10">
                        <h1>selenium入门使用</h1>
                        <div class="meta text-muted mb-3" style="text-align: right;">
                            
                            <p class="created text-muted text-uppercase font-weight-bold mb-1">April 8, 2020</p>
                            <span class="mr-2"><i class="fas fa-book-open mr-2"></i>2102</span>
                            <span><i class="fas fa-clock mr-2"></i>9 minutes and
                                33 seconds</span>
                        </div>
                        <div class="category my-3"><a class="badge badge-pill badge-light border mr-2" href="/categories/%E7%88%AC%E8%99%AB%E7%B3%BB%E5%88%97">
                                    <i class="fas fa-tag mr-2"></i>爬虫系列
                                </a></div></div>
                </div><div class="row justify-content-center mb-3">
                                <div class="col-lg-10">
                                    <img data-src="/images/spider-requests_huc4b4663bc63a0e31a40f04bc97652a90_494620_900x500_fit_q75_box.jpg" class="img-fluid rounded mx-auto d-block" alt="selenium入门使用">
                                </div>
                            </div><div class="row justify-content-center">
                    <div class="col-lg-10">
                        <div class="content">
                            <blockquote>
<p>[DeadPool爬虫]selenium入门使用</p>
</blockquote>
<p>前一篇博客内容的代码中，已经使用了webdirver的功能，这个功能帮助我们在浏览器中打开网页，并且使我们能够对加载后的网页进行实时操作，这么神器的功能，来源于selenium这个框架，其实其本身定义是一个前端自动化测试框架，但是因为其特性，能够帮助我们很好的实现爬虫的功能，因此现在在爬虫领域其也是必须掌握的存在，接下来我就简单总结以下selenium的基础使用，高级使用同样需要在不断地编码中去掌握并同时查看其官方文档~</p>
<blockquote>
<p><a href="https://selenium-python.readthedocs.io/">selenium官方文档</a></p>
</blockquote>
<h5 id="selenium-框架">selenium 框架</h5>
<p>Selenium 是 ThroughtWorks 一个强大的基于浏览器的开源自动化测试工具，它通常用来编写Web应用的自动化测试。</p>
<p>其本身就是一个独立的框架，拥有自己开的 IDE 工具，所以在爬虫领域里面通常是使用 selenium 中的webdirver模块来实现对浏览器的API调用。这里我们使用的就是 Python 的接口包</p>
<p>安装就也是简单的 <code>pip install selenium</code> 就可以了。</p>
<blockquote>
<p>PS: 推荐大家使用virtualenv的方式</p>
</blockquote>
<p>既然是用的是 selenium 中 webdirver 模块的功能，所以首先你需要在你的设备上拥有浏览器，同时下载该浏览器的对应驱动程序，这里不同的浏览器驱动不同，列举如下:</p>
<p>Chrome: <a href="https://sites.google.com/a/chromium.org/chromedriver/downloads">https://sites.google.com/a/chromium.org/chromedriver/downloads</a>
Firefox: <a href="https://github.com/mozilla/geckodriver/releases">https://github.com/mozilla/geckodriver/releases</a>
Safari: <a href="https://webkit.org/blog/6900/webdriver-support-in-safari-10/">https://webkit.org/blog/6900/webdriver-support-in-safari-10/</a>
Edge: <a href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/">https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/</a></p>
<blockquote>
<p>PS: 博文的最末附件会带上 chrome 的最新驱动（三个平台的）</p>
</blockquote>
<h5 id="selenium-上手">selenium 上手</h5>
<p>这里简单的 selenium 使用就以官方文档中的例子为基础，里面稍微修改了一点</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>

<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s2">&#34;E:</span><span class="se">\\</span><span class="s2">Github</span><span class="se">\\</span><span class="s2">Lesson</span><span class="se">\\</span><span class="s2">chromedriver.exe&#34;</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;http://www.python.org&#34;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&#34;Python&#34;</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span>
<span class="n">elem</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s2">&#34;q&#34;</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&#34;pycon&#34;</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">RETURN</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&#34;No results found.&#34;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">page_source</span>
<span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

</code></pre></div><p>这里与官方不同的是使用的 Chrome 作为浏览器，同时加载了驱动位置，其实很多博文和教程都是将驱动程序添加到了 windows 系统环境变量中，或者是放到了 selenium 安装的路径下，这里其实完全没有必要，因为只需要在加载的时候指定位置就行了，还方便根据不同的版本，来加载不同的驱动~</p>
<p>接下来简单解释一下上面的代码</p>
<p>===</p>
<p>这两个导包动作其实就是导入了selenium对应的webdirver模块和键盘绑定Keys，即你的回车、F1等</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.keys</span> <span class="kn">import</span> <span class="n">Keys</span>
</code></pre></div><p>===</p>
<p>这就是我前面说的实例化webdriver的时候指定驱动目录就行了</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s2">&#34;E:</span><span class="se">\\</span><span class="s2">Github</span><span class="se">\\</span><span class="s2">Lesson</span><span class="se">\\</span><span class="s2">chromedriver.exe&#34;</span><span class="p">)</span>
</code></pre></div><p>===</p>
<p>打开页面访问指定网址，并同时判断网页打开是否正确（assert 断言，PS: Python test 中经常使用）</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;http://www.python.org&#34;</span><span class="p">)</span>
<span class="k">assert</span> <span class="s2">&#34;Python&#34;</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">title</span>
</code></pre></div><p>===</p>
<p>在当前页面找到name为<code>q</code>的元素，其实就是python官网的搜索输入框，清除内容，填写内容，按下回车</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="n">elem</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s2">&#34;q&#34;</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&#34;pycon&#34;</span><span class="p">)</span>
<span class="n">elem</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="n">Keys</span><span class="o">.</span><span class="n">RETURN</span><span class="p">)</span>
</code></pre></div><p>===</p>
<p>判断当前页面内容里面是否存在指定字符串，然后关闭浏览器</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="k">assert</span> <span class="s2">&#34;No results found.&#34;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">page_source</span>
<span class="n">driver</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div><blockquote>
<p>PS: 一定要记得关闭浏览器，不然你会在不停的尝试中打开越来越多的浏览器</p>
</blockquote>
<h5 id="selenium-与页面交互">selenium 与页面交互</h5>
<p>首先要对页面元素进行交互第一点就是定位元素位置，这里需要你有一定的html和css基础了，不过很好掌握。具体如何查找元素，总结如下：</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="c1"># find a element</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_link_text</span><span class="p">()</span>  <span class="c1"># a 标签中的文本内容</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_partial_link_text</span><span class="p">()</span>  <span class="c1"># 非全匹配 a 标签中的文本内容</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_tag_name</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_class_name</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_css_selector</span><span class="p">()</span>

<span class="c1"># 上面的方法可以统一为</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//button[text()=&#34;Some text&#34;]&#39;</span><span class="p">)</span>

<span class="c1"># find the elements</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_id</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_name</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_xpath</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_link_text</span><span class="p">()</span>  <span class="c1"># a 标签中的文本内容</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_partial_link_text</span><span class="p">()</span>  <span class="c1"># 非全匹配 a 标签中的文本内容</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_class_name</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_elements_by_css_selector</span><span class="p">()</span>

<span class="c1"># 上面的方法可以统一为</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_elements</span><span class="p">(</span><span class="n">By</span><span class="o">.</span><span class="n">XPATH</span><span class="p">,</span> <span class="s1">&#39;//button&#39;</span><span class="p">)</span>

</code></pre></div><p>其中都很简单，主要比较特别的就是 XPath 这个东西了，不过也有其标准 W3C XPATH</p>
<blockquote>
<p><a href="https://www.w3schools.com/xml/xpath_intro.asp">W3C XPath Tutorial</a></p>
</blockquote>
<p>然后元素找到了之后，怎么与之进行交互呢？其实简单想象一下，前端页面的交互主要分为两种形式：一种是输入；一种是点击。因此归纳的方式也就分为这两种</p>
<h6 id="输入">输入</h6>
<p>例如下面这个密码输入框，可以通过下面的代码找到该输入框之后，清空内容，填写内容。</p>
<div class="highlight"><pre class="chroma"><code class="language-HTML" data-lang="HTML">
<span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;text&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;passwd&#34;</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;passwd-id&#34;</span> <span class="p">/&gt;</span>

</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&#34;passwd-id&#34;</span><span class="p">)</span>
<span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s2">&#34;passwd&#34;</span><span class="p">)</span>
<span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&#34;//input[@id=&#39;passwd-id&#39;]&#34;</span><span class="p">)</span>

<span class="n">element</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">element</span><span class="o">.</span><span class="n">send_keys</span><span class="p">(</span><span class="s2">&#34;some text&#34;</span><span class="p">)</span>

</code></pre></div><p>除了输入框，还有就是选择框，本质上任然是输入框，但是需要通过点击来实现的内容输入，这里我仍然建议以其HTML本身的含义来定义其类型，这是一种输入操作。</p>
<div class="highlight"><pre class="chroma"><code class="language-HTML" data-lang="HTML">
<span class="p">&lt;</span><span class="nt">select</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;form-control&#34;</span> <span class="na">name</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;1&#34;</span><span class="p">&gt;</span>1<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;2&#34;</span><span class="p">&gt;</span>2<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;3&#34;</span><span class="p">&gt;</span>3<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;4&#34;</span><span class="p">&gt;</span>4<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
  <span class="p">&lt;</span><span class="nt">option</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;5&#34;</span><span class="p">&gt;</span>5<span class="p">&lt;/</span><span class="nt">option</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">select</span><span class="p">&gt;</span>

</code></pre></div><div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python"><span class="c1"># 常规方法</span>
<span class="c1"># 选择全部的 options</span>
<span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&#34;//select[@name=&#39;name&#39;]&#34;</span><span class="p">)</span>
<span class="n">all_options</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">find_elements_by_tag_name</span><span class="p">(</span><span class="s2">&#34;option&#34;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">option</span> <span class="ow">in</span> <span class="n">all_options</span><span class="p">:</span>
    <span class="k">print</span><span class="p">(</span><span class="s2">&#34;Value is: </span><span class="si">%s</span><span class="s2">&#34;</span> <span class="o">%</span> <span class="n">option</span><span class="o">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s2">&#34;value&#34;</span><span class="p">))</span>
    <span class="n">option</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

<span class="c1"># Selenium 中的UI库 进行找寻select</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">Select</span>
<span class="n">select</span> <span class="o">=</span> <span class="n">Select</span><span class="p">(</span><span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_xpath</span><span class="p">(</span><span class="s2">&#34;//select[@name=&#39;name&#39;]&#34;</span><span class="p">))</span>

<span class="c1"># 列举全部的options</span>
<span class="n">options</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">options</span>

<span class="c1"># 选择特定的options</span>
<span class="n">select</span><span class="o">.</span><span class="n">select_by_index</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
<span class="n">select</span><span class="o">.</span><span class="n">select_by_visible_text</span><span class="p">(</span><span class="s2">&#34;text&#34;</span><span class="p">)</span>
<span class="n">select</span><span class="o">.</span><span class="n">select_by_value</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="c1"># 查看当前选中的options</span>
<span class="n">selected_options</span> <span class="o">=</span> <span class="n">select</span><span class="o">.</span><span class="n">all_selected_options</span>

<span class="c1"># 选择全部的options</span>
<span class="n">select</span><span class="o">.</span><span class="n">select_all</span><span class="p">()</span>

<span class="c1"># 重置全部的选择</span>
<span class="n">select</span><span class="o">.</span><span class="n">deselect_all</span><span class="p">()</span>

</code></pre></div><h6 id="点击">点击</h6>
<p>对于点击事件，可以总结为两个方式: 1、点击动作直接完成；2、点击动作间隔完成。与之对应的就是点击和拖拽，其本质是一样的，只不过是点下和松开的时间间隔不同而已</p>
<p>针对点击直接完成（点击）</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="c1"># 找到对应的button之后，直接触发点击事件即可</span>
<span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_id</span><span class="p">(</span><span class="s2">&#34;submit&#34;</span><span class="p">)</span><span class="o">.</span><span class="n">click</span><span class="p">()</span>

</code></pre></div><p>针对点击间隔完成（拖拽）</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="c1"># 找到目标元素和最终位置，执行拖拽效果</span>
<span class="n">element</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s2">&#34;source&#34;</span><span class="p">)</span>
<span class="n">target</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">find_element_by_name</span><span class="p">(</span><span class="s2">&#34;target&#34;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">selenium.webdriver</span> <span class="kn">import</span> <span class="n">ActionChains</span>
<span class="n">action_chains</span> <span class="o">=</span> <span class="n">ActionChains</span><span class="p">(</span><span class="n">driver</span><span class="p">)</span>
<span class="n">action_chains</span><span class="o">.</span><span class="n">drag_and_drop</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">perform</span><span class="p">()</span>

</code></pre></div><p>相比输入这个点击动作就要简单一些</p>
<h5 id="selenium-附加功能">selenium 附加功能</h5>
<h6 id="popup-dialogs">Popup dialogs</h6>
<p>对于弹出的对话框支持</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="n">alert</span> <span class="o">=</span> <span class="n">driver</span><span class="o">.</span><span class="n">switch_to_alert</span><span class="p">()</span>

</code></pre></div><h6 id="history-and-location">history and location</h6>
<p>浏览器的访问地址和历史</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;http://www.example.com&#34;</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">forward</span><span class="p">()</span>
<span class="n">driver</span><span class="o">.</span><span class="n">back</span><span class="p">()</span>

</code></pre></div><h6 id="windows-and-iframe">windows and iframe</h6>
<p>切换打开的窗口和嵌入的iframe</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="c1"># 轮流切换当前打开的窗口</span>
<span class="k">for</span> <span class="n">handle</span> <span class="ow">in</span> <span class="n">driver</span><span class="o">.</span><span class="n">window_handles</span><span class="p">:</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">switch_to_window</span><span class="p">(</span><span class="n">handle</span><span class="p">)</span>

<span class="c1"># 切换当前的iframe</span>
<span class="n">driver</span><span class="o">.</span><span class="n">switch_to_frame</span><span class="p">(</span><span class="s2">&#34;frameName&#34;</span><span class="p">)</span>
<span class="c1"># 或者直接切换到里面的元素</span>
<span class="n">driver</span><span class="o">.</span><span class="n">switch_to_frame</span><span class="p">(</span><span class="s2">&#34;frameName.0.child&#34;</span><span class="p">)</span>


<span class="c1"># 回到默认窗口</span>
<span class="n">driver</span><span class="o">.</span><span class="n">switch_to_default_content</span><span class="p">()</span>

</code></pre></div><h6 id="cookies">cookies</h6>
<p>获取和增加当前域下的cookies</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="c1"># Go to the correct domain</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;http://www.example.com&#34;</span><span class="p">)</span>

<span class="c1"># Now set the cookie. This one&#39;s valid for the entire domain</span>
<span class="n">cookie</span> <span class="o">=</span> <span class="p">{</span><span class="err">‘</span><span class="n">name</span><span class="err">’</span> <span class="p">:</span> <span class="err">‘</span><span class="n">foo</span><span class="err">’</span><span class="p">,</span> <span class="err">‘</span><span class="n">value</span><span class="err">’</span> <span class="p">:</span> <span class="err">‘</span><span class="n">bar</span><span class="err">’</span><span class="p">}</span>
<span class="n">driver</span><span class="o">.</span><span class="n">add_cookie</span><span class="p">(</span><span class="n">cookie</span><span class="p">)</span>

<span class="c1"># And now output all the available cookies for the current URL</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get_cookies</span><span class="p">()</span>

</code></pre></div><h5 id="selenium-显式等待">selenium 显式等待</h5>
<p>简单来说就是判断你打开页面的过程中是否加载完成</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.common.by</span> <span class="kn">import</span> <span class="n">By</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support.ui</span> <span class="kn">import</span> <span class="n">WebDriverWait</span>
<span class="kn">from</span> <span class="nn">selenium.webdriver.support</span> <span class="kn">import</span> <span class="n">expected_conditions</span> <span class="k">as</span> <span class="n">EC</span>

<span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="o">.</span><span class="n">Chrome</span><span class="p">(</span><span class="n">executable_path</span><span class="o">=</span><span class="s2">&#34;E:</span><span class="se">\\</span><span class="s2">Github</span><span class="se">\\</span><span class="s2">Lesson</span><span class="se">\\</span><span class="s2">chromedriver.exe&#34;</span><span class="p">)</span>
<span class="n">driver</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;http://somedomain/url_that_delays_loading&#34;</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">element</span> <span class="o">=</span> <span class="n">WebDriverWait</span><span class="p">(</span><span class="n">driver</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">until</span><span class="p">(</span>
        <span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s2">&#34;myDynamicElement&#34;</span><span class="p">))</span>
    <span class="p">)</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="n">driver</span><span class="o">.</span><span class="n">quit</span><span class="p">()</span>

</code></pre></div><p>其中可以支持的触发动作包含一下方式：</p>
<div class="highlight"><pre class="chroma"><code class="language-Python" data-lang="Python">
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">title_is</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">title_contains</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">visibility_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">visibility_of</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">presence_of_all_elements_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">text_to_be_present_in_element</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">text_to_be_present_in_element_value</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">EC</span><span class="o">.</span><span class="n">invisibility_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">frame_to_be_available_and_switch_to_it</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">invisibility_of_element_located</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">element_to_be_clickable</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">staleness_of</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">element_to_be_selected</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">element_located_to_be_selected</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">element_selection_state_to_be</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">element_located_selection_state_to_be</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>
<span class="n">wait</span><span class="o">.</span><span class="n">until</span><span class="p">(</span><span class="n">alert_is_present</span><span class="p">((</span><span class="n">By</span><span class="o">.</span><span class="n">ID</span><span class="p">,</span> <span class="s1">&#39;someid&#39;</span><span class="p">)))</span>

</code></pre></div><p>以上，就是通过我自己对于selenium官方文档的知识总结，当然还有具体的高级使用方法，后续有机会的话，会将我遇到的一些问题挨个介绍一下~</p>
<h5 id="附件">附件：</h5>

<section class="attachments grey">
	<label>
		<span>
			<i class="fa fa-paperclip"></i>
		</span>
		Attachments
	</label>
	
		
	
	<div class="attachments-files">
	
		
		
			<li>
				<a href="/posts/0x000014.files/chromedriver_linux64.zip" >
					chromedriver_linux64.zip
				</a>
				(4826 kb)
			</li>
		
	
		
		
			<li>
				<a href="/posts/0x000014.files/chromedriver_mac64.zip" >
					chromedriver_mac64.zip
				</a>
				(6838 kb)
			</li>
		
	
		
		
			<li>
				<a href="/posts/0x000014.files/chromedriver_win32.zip" >
					chromedriver_win32.zip
				</a>
				(4268 kb)
			</li>
		
	
	<div>
	
</section>

                        </div><div class="tags my-3"><a class="badge badge-pill badge-light border mr-2" href="/tags/spider/">
                                    <i class="fas fa-tag mr-2"></i>spider
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/requests/">
                                    <i class="fas fa-tag mr-2"></i>requests
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/%E7%88%AC%E8%99%AB/">
                                    <i class="fas fa-tag mr-2"></i>爬虫
                                </a></div><div style="text-align: center;">
                            <div class="social-share" data-sites="wechat,weibo,twitter,facebook,douban" data-mobile-sites="wechat,weibo"></div>
                        </div>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        

<div id="comments-gittalk"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script> 
    <script>
    var gittalk = new Gitalk({
        id: '0x000014',
        owner: 'Ryuchen',
        repo: 'ryuchen.github.io',
        admin: ['Ryuchen'],
        clientID: 'cda75f43f62ef6ebc3ea',
        clientSecret: 'e405fb603c664a6436a481917a7ee70931413268',
    })
    gittalk.render('comments-gittalk')
    </script>



                    </div>
                </div>
            </article>
        </div>
    </div>

    <div class="related-content row mt-5 row-cols-1 row-cols-lg-3"><div class="col mb-3">
                <div class="card h-100 shadow">
    
    <a href="/posts/0x000013/" class="d-block">
                        <img data-src="https://cdn.jsdelivr.net/gh/Ryuchen/ryuchen.github.io@master/images/spider-requests_huc4b4663bc63a0e31a40f04bc97652a90_494620_700x350_resize_q75_box.jpg" class="card-img-top mx-auto d-block" alt="梨视频高级爬取">
                    <div class="card-body">
            <div class="card-title">
                梨视频高级爬取
            </div><div class="card-serie"><span class="badge badge-pill badge-primary">爬虫系列</span> &nbsp;</div><p class="card-text text-muted text-uppercase">April 3, 2020</p>
            <div class="card-text">
                这是一个系列内容，最近女友在跟我学习Python编程，然后就开了这个爬虫系列，主要也是借此机会将自己所会的爬虫相关的知识进行梳理并同时做好备课工作~~【如果这个系列对你有帮助的话，请在这个博客下面留言，我会尽可能做好思路梳理】
            </div>
        </div>
    </a>
</div>

            </div><div class="col mb-3">
                <div class="card h-100 shadow">
    
    <a href="/posts/0x000012/" class="d-block">
                        <img data-src="https://cdn.jsdelivr.net/gh/Ryuchen/ryuchen.github.io@master/images/spider-requests_huc4b4663bc63a0e31a40f04bc97652a90_494620_700x350_resize_q75_box.jpg" class="card-img-top mx-auto d-block" alt="梨视频初级爬取">
                    <div class="card-body">
            <div class="card-title">
                梨视频初级爬取
            </div><div class="card-serie"><span class="badge badge-pill badge-primary">爬虫系列</span> &nbsp;</div><p class="card-text text-muted text-uppercase">March 31, 2020</p>
            <div class="card-text">
                这是一个系列内容，最近女友在跟我学习Python编程，然后就开了这个爬虫系列，主要也是借此机会将自己所会的爬虫相关的知识进行梳理并同时做好备课工作~~【如果这个系列对你有帮助的话，请在这个博客下面留言，我会尽可能做好思路梳理】
            </div>
        </div>
    </a>
</div>

            </div><div class="col mb-3">
                <div class="card h-100 shadow">
    
    <a href="/posts/0x000010/" class="d-block">
                        <img data-src="https://cdn.jsdelivr.net/gh/Ryuchen/ryuchen.github.io@master/images/spider-requests_huc4b4663bc63a0e31a40f04bc97652a90_494620_700x350_resize_q75_box.jpg" class="card-img-top mx-auto d-block" alt="requests入门使用">
                    <div class="card-body">
            <div class="card-title">
                requests入门使用
            </div><div class="card-serie"><span class="badge badge-pill badge-primary">爬虫系列</span> &nbsp;</div><p class="card-text text-muted text-uppercase">March 24, 2020</p>
            <div class="card-text">
                这是一个系列内容，最近女友在跟我学习Python编程，然后就开了这个爬虫系列，主要也是借此机会将自己所会的爬虫相关的知识进行梳理并同时做好备课工作~~【如果这个系列对你有帮助的话，请在这个博客下面留言，我会尽可能做好思路梳理】
            </div>
        </div>
    </a>
</div>

            </div></div>
</main>

        <footer class="footer bg-dark py-6">
    <div class="container">
        <div class="row">
            <div class="col-sm text-center">
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="https://ryuchen.club/index.xml" rel="alternate" type="application/rss+xml" class="icons d-block">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a></li><li class="list-inline-item">
                        <a href="mailto:chenhaom1993@hotmail.com" class="icons d-block">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li><li class="list-inline-item">
                            <a href="https://github.com/Ryuchen" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://weibo.com/u/3147247770" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-weibo fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                </ul>

                <p class="text-muted">
                    
                        Copyright © 2018–2020, WangOO and Ryuchen, all rights reserved.
                    
                </p>

                <p class="text-muted">
                    京ICP备2020040667号
                </p>

                <p class="text-muted">
                    本站总记被访问 <span id="busuanzi_value_site_pv"></span> 次， 
                    您是第 <span id="busuanzi_value_site_uv"></span> 个来访小伙伴。
                </p>
            </div>
            <div class="col-sm text-center"><p class="text-muted">维护不易，渴望您的资助</p><ul class="list-inline">
                    <div class="row">
                        <div class="col-sm text-center"><li class="list-inline-item">
                                <img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@sponsor/wechat.jpg" alt="WechatPay" class="loaded" data-was-processed="true" style="width: 140px;padding: 4px">
                            </li></div>
                        <div class="col-sm text-center"><li class="list-inline-item">
                                <img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@sponsor/alipay.jpg" alt="AliPay" class="loaded" data-was-processed="true" style="width: 140px;padding: 4px">
                            </li></div>
                    </div>
                </ul>
            </div>
        </div>
    </div>
    <div class="netease-music">
            <audio id="music-player" crossorigin playsinline>
            </audio>
        </div>
    
</footer>

        
    
        
            <script src='/dist/main.bf9558b8596b4accd07a.min.js'></script>
        
    



<script src='https://cdn.jsdelivr.net/gh/Ryuchen/ryuchen.github.io@master//mermaid/mermaid.js'></script>



    <script>
        window.Prism = window.Prism || {};
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/autoloader/prism-autoloader.min.js"></script>





<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https'){
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else{
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>


<script>
    (function(){
    var el = document.createElement("script");
    el.src = "https://s3a.pstatp.com/toutiao/push.js?1b349c44e658214c68be3a649c8dd67d03df3ccff5cf4d26c95620535e04d891417631efa03c64873bef9496a5c9bb7c62f7c4af6b1a55b161baff8a0b4e2fba";
    el.id = "ttzz";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(el, s);
    })(window)
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"  crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js" integrity="sha256-fGPu+icKh985TLPhO2v68U7i0CW0dE4kiR06RN4O6jo=" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-0EFH27TG1R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-0EFH27TG1R');
</script>
    </body>
</html>
