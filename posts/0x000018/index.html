<!DOCTYPE html>
<html lang='zh'>
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">
<title>
  
     [读书笔记]《西瓜书》第二章 模型评估与选择 |  Sweet House
  
</title>


  <meta name="description" content="Everyday is a holiday">


<meta name="bytedance-verification-code" content="MmXZwSvr8lAvM1hIXSkm" />

<meta name="author" content='[Ryuchen WangOO]'>

<link rel="icon" href='/favicon.ico'>


  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/themes/prism-dark.min.css">
  



  
      
        <link rel="stylesheet" href='/dist/main.4707e15c5ca4eab5da71.min.css'>
      
  


<link rel="stylesheet" href='/css/shortcodes.css'>

<link rel="canonical" href="https://ryuchen.club/posts/0x000018/"><meta property="og:title" content="[读书笔记]《西瓜书》第二章 模型评估与选择" />
<meta property="og:description" content="周志华《机器学习》俗称西瓜书，自己的读书笔记 Chapter: 2.模型评估与选择" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ryuchen.club/posts/0x000018/" />
<meta property="og:image" content="https://ryuchen.club/machine-learning.jpg" />
<meta property="article:published_time" content="2020-10-27T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-10-27T00:00:00+00:00" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000035/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000034/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000033/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000032/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000031/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000030/" />

<meta itemprop="name" content="[读书笔记]《西瓜书》第二章 模型评估与选择">
<meta itemprop="description" content="周志华《机器学习》俗称西瓜书，自己的读书笔记 Chapter: 2.模型评估与选择">
<meta itemprop="datePublished" content="2020-10-27T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-10-27T00:00:00+00:00" />
<meta itemprop="wordCount" content="637">
<meta itemprop="image" content="https://ryuchen.club/machine-learning.jpg">



<meta itemprop="keywords" content="周志华,模型评估与选择,西瓜书," />

    </head>
    <body>
        
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://ryuchen.club"> >$ cd /home_</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-menu">
            <ul class="navbar-nav ml-auto">
                    
                        <li class='nav-item'><a class="nav-link" href="/">首页</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/posts/">博文</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/projects/">项目</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/snippet/">代码</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/essay/">随笔</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/gallery/">照片墙</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/about/">关于</a></li>
                    
                
                <li class="nav-item"><a class="nav-link" href="https://github.com/Ryuchen" target="_blank">Github</a></li>
            </ul>
        </div>
    </div>
</nav>

        
<main class="content-page container pt-7 pb-5">
    
    <div class="row">
        <div class="col">
            <article>
                <div class="row justify-content-center">
                    <div class="col-lg-10">
                        <h1>[读书笔记]《西瓜书》第二章 模型评估与选择</h1>
                        <div class="meta text-muted mb-3" style="text-align: right;">
                            
                            <p class="created text-muted text-uppercase font-weight-bold mb-1">October 27, 2020</p>
                            <span class="mr-2"><i class="fas fa-book-open mr-2"></i>5603</span>
                            <span><i class="fas fa-clock mr-2"></i>25 minutes and
                                28 seconds</span>
                        </div>
                        <div class="category my-3"><a class="badge badge-pill badge-light border mr-2" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0">
                                    <i class="fas fa-tag mr-2"></i>机器学习
                                </a></div></div>
                </div><div class="row justify-content-center mb-3">
                                <div class="col-lg-10">
                                    <img data-src="/images/machine-learning_huda146d3825fc6d502e05b38609bff098_23368_900x500_fit_q75_box.jpg" class="img-fluid rounded mx-auto d-block" alt="[读书笔记]《西瓜书》第二章 模型评估与选择">
                                </div>
                            </div><div class="row justify-content-center">
                    <div class="col-lg-10">
                        <div class="content">
                            <h2 id="第二章-模型评估与选择">第二章 模型评估与选择</h2>
<hr>
<h2 id="21-经验误差与过拟合">2.1 经验误差与过拟合</h2>
<h3 id="基本概念">基本概念</h3>
<h5 id="错误率error-rate">错误率（error rate）</h5>
<p>把分类错误的样本数占样本总数的比例</p>
<ul>
<li>$E=a/m$</li>
</ul>
<h5 id="精度accuracy">精度（accuracy）</h5>
<p>精度 = 1 - 错误率</p>
<ul>
<li>$E=1-a/m$</li>
</ul>
<h5 id="误差error">误差（error）</h5>
<blockquote>
<p>均指误差期望</p>
</blockquote>
<ul>
<li>把学习器的实际预测输出与样本的真实输出之间的差异称为误差</li>
<li>学习器在训练集上的误差称为 “训练误差”（training error）或 “经验误差”（empirical error）</li>
<li>在新样本上的误差称为 “泛化误差”（generalization error）</li>
</ul>
<blockquote>
<p><strong>机器学习的目标：得到泛化误差小的学习器</strong></p>
</blockquote>
<p><strong>机器学习的关键障碍，无法彻底避免，只能“缓解”</strong></p>
<blockquote>
<p>补充：(因为这是一个 P = NP 问题：P就是能在多项式时间内解决的问题，NP就是能在多项式时间验证答案正确与否的问题)</p>
</blockquote>
<h5 id="过拟合overfitting">过拟合（overfitting）</h5>
<ul>
<li>把训练样本自身的一些特点当作了潜在样本都会有的一般性质</li>
<li>又称 “过配”</li>
</ul>
<h5 id="欠拟合underfitting">欠拟合（underfitting）</h5>
<ul>
<li>指对训练样本的一般性质尚未学好</li>
<li>又称 “欠配”</li>
</ul>
<blockquote>
<p>衡量学习能力是否 “强大”：学习算法 和 数据内涵</p>
</blockquote>
<h3 id="模型选择model-selection问题">模型选择（model selection）问题</h3>
<h2 id="22-评估方法">2.2 评估方法</h2>
<h3 id="实验测试">实验测试</h3>
<h5 id="测试集testing-set">测试集（testing set）</h5>
<ul>
<li>从样本真实分布中独立同分布采样的</li>
<li>测试机与训练集尽可能互斥</li>
</ul>
<blockquote>
<p><strong>测试误差（testing error）$\approx$ 泛化误差</strong></p>
</blockquote>
<h4 id="分层采样stratified-sampling">分层采样（stratified sampling）</h4>
<h5 id="留出法hold-out">留出法（hold-out）</h5>
<p>直接将数据集划分为两个互斥的集合</p>
<!-- raw HTML omitted -->
<blockquote>
<p>测试集较小时，评估结果的方差较大；训练集小时，评估结果的偏差较大</p>
</blockquote>
<blockquote>
<p>常见做法 2/3 ~ 4/5 的样本作为训练集，剩余样本用于测试</p>
</blockquote>
<h5 id="交叉验证法cross-validation">交叉验证法（cross validation）</h5>
<p>将数据集划分为k个大小相似的互斥子集</p>
<!-- raw HTML omitted -->
<blockquote>
<p>每个子集都应该尽可能保持数据分布的一致性，即从D中分层采样得到</p>
</blockquote>
<p>每次用k-1个子集的并集作为训练集，余下的那个子集作为测试集</p>
<ul>
<li>拥有k组的训练和测试集</li>
<li>可进行k次训练和测试</li>
<li>最终结果为k次结果取均值</li>
</ul>
<blockquote>
<p>与留出法相似，每次划分会影响结果，因此需要使用不同的划分重复 p 次，即 p 次 k 折交叉验证 == p * k 次留出法</p>
</blockquote>
<blockquote>
<p>当k和数据集数量一致时，称之为留一法（Leave One Out）简称：LOO</p>
</blockquote>
<ul>
<li>相当准确，不受划分影响</li>
<li>模型计算开销大</li>
</ul>
<h4 id="自助采样bootstrap-sampling">自助采样（bootstrap sampling）</h4>
<h5 id="自助法bootstrapping">自助法（bootstrapping）</h5>
<h6 id="自助采样过程">自助采样过程</h6>
<p>$Step1$: 对包含m个样本的数据集$D$，进行采样产生数据集$D'$</p>
<p>$Step2$:每次随机从$D$中挑选一个样本，将其拷贝放入$D'$中</p>
<p>$Step3$:步骤二重复$m$次，得到包含$m$个样本的数据集$D'$，就是最终结果</p>
<h6 id="自助采样的特点">自助采样的特点</h6>
<blockquote>
<p>$D'$ 中会有一部分重复样本</p>
</blockquote>
<blockquote>
<p>样本在$m$次采样中始终不被采到的概率是$(1-\frac{1}{m})^m$</p>
</blockquote>
<blockquote>
<p>$\lim_{m\to\infty}(1-\frac{1}{m})^m = \frac{1}{e}\approx 0.368$</p>
</blockquote>
<p>通过自助采样，初始数据集中约有36.8%的样本未出现在采样数据集中</p>
<p>$D'$用作训练集，$D \backslash D'$作为测试集 ($\backslash$ 代表集合减法)</p>
<ul>
<li>实际评估的模型和期望评估的模型都有使用m个训练样本</li>
<li>越有 1/3 的数据没有出现在训练集中，用于测试</li>
</ul>
<p><strong>测试结果，称为 “包外估计” （out of bag estimate）</strong></p>
<h3 id="调参与最终模型">调参与最终模型</h3>
<h5 id="调参parameter-tuning">调参（parameter tuning）</h5>
<p>参数类型</p>
<ul>
<li>
<p>超参数: 算法本身的参数, 数目常在10个以内, 人工设定多个参数候选值后产生模型</p>
</li>
<li>
<p>参数: 模型的参数, 数目可能很多, 通过学习来产生多个候选模型</p>
</li>
</ul>
<blockquote>
<p>理想状态是对每种取值都做模型训练</p>
</blockquote>
<blockquote>
<p>对每一个参数选定一个选参范围和变化步长</p>
</blockquote>
<h5 id="最终模型">最终模型</h5>
<p>$Step1$: 将包含$m$个样本的数据集$D$，拆分成训练数据和测试数据</p>
<p>$Step2$: 对训练数据拆分成训练集和验证集</p>
<p>$Step3$: 使用训练集训练模型，借助验证集调整超参数，选定模型</p>
<p>$Step4$: 通过测试集对模型进行最终的评估</p>
<p>$Step5$: 最终使用全部$m$个样本按选定的算法和参数设置训练模型</p>
<h2 id="23-性能度量">2.3 性能度量</h2>
<h3 id="定义">定义</h3>
<p>对学习器的泛化性能进行评估，不仅需要有效可行的实验估计方法，还需要有衡量模型泛化能力的评价标准，这就是性能度量（performance measure）</p>
<h3 id="均方误差mean-squared-error">均方误差（mean squared error）</h3>
<blockquote>
<p>回归任务最常用</p>
</blockquote>
<p>给定样例集$D=\left\{(\boldsymbol{x_1}, y_1),(\boldsymbol{x_2}, y_2),&hellip;,(\boldsymbol{x_m}, y_m)\right\}$，其中$y_i$是示例$\boldsymbol{x_i}$的真实标记</p>
<p>$E(f;D)=\frac{1}{m}\sum_{i=1}^m(f(\boldsymbol{x_i})-y_i)^2$</p>
<p>$E(f;D)=\int_{\boldsymbol{x}\sim D}(f(\boldsymbol{x})-y)^2p(\boldsymbol{x})d\boldsymbol{x}$</p>
<h3 id="错误率和精度">错误率和精度</h3>
<h4 id="错误率error-rate-1">错误率（error rate）</h4>
<blockquote>
<p>分类错误的样本数占样本总数的比例</p>
</blockquote>
<ul>
<li>$E(f;D)=\frac{1}{m}\sum_{i=1}^m\mathbb{I}(f(\boldsymbol{x_i})\neq y_i)$</li>
<li>$E(f;D)=\int_{\boldsymbol{x}\sim D}\mathbb{I}(f(\boldsymbol{x})\neq y)p(\boldsymbol{x})d\boldsymbol{x}$</li>
</ul>
<h4 id="精度accuracy-1">精度（accuracy）</h4>
<blockquote>
<p>分类正确的样本数占样本总数的比例</p>
</blockquote>
<ul>
<li>$acc(f;D) = \frac{1}{m}\sum_{i=1}^m\mathbb{I}(f(\boldsymbol{x_i})= y_i)$</li>
<li>$E(f;D)=\int_{\boldsymbol{x}\sim D}\mathbb{I}(f(\boldsymbol{x})= y)p(\boldsymbol{x})d\boldsymbol{x}$</li>
</ul>
<h3 id="查全率--查准率--f1">查全率 &amp; 查准率 &amp; F1</h3>
<h4 id="分类混淆矩阵">分类混淆矩阵</h4>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/26/664b92e0ccd0a1d7abae587f216cbeeb.webp" alt="分类混淆矩阵"></p>
<blockquote>
<p>纵向是预测，横向是真实</p>
</blockquote>
<blockquote>
<p>纵向排在真实后</p>
</blockquote>
<ul>
<li>真正例（true positive）TP</li>
<li>假正例（false positive）FP</li>
<li>真反例（true negative）TN</li>
<li>假反例（false negative）FN</li>
</ul>
<h5 id="查准率-pprecision-准确率">查准率 P（precision）&amp; 准确率</h5>
<ul>
<li>“挑出的西瓜中有多少是好瓜”</li>
<li>$P = \frac {TP} {TP+FP}$</li>
</ul>
<h5 id="查全率-rrecall-召回率">查全率 R（recall）&amp; 召回率</h5>
<ul>
<li>“所有好瓜中有多少的比例被挑了出来”</li>
<li>$R = \frac {TP} {TP + FN}$</li>
</ul>
<h5 id="p-r-曲线">P-R 曲线</h5>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/26/25578872d9b3e4bf7c0337754902bdd0.webp" alt="P-R 曲线"></p>
<blockquote>
<p>以查准率为纵轴，查全率为横轴作图</p>
</blockquote>
<p>如何利用P-R曲线判定两个学习器的性能?</p>
<h6 id="比较曲线下的面积的大小">比较曲线下的面积的大小</h6>
<ul>
<li>“平衡点”（Break-Even Point）BEP</li>
<li>“查准率=查全率”时的取值</li>
</ul>
<h6 id="f1-度量">$F1$ 度量</h6>
<ul>
<li>$F1=\frac{2 \times P \times R}{P + R}=\frac{2\times TP}{m+TP-TN}$</li>
<li>源于查准率与查全率的调和平均（harmonic mean）
<ul>
<li>$\frac{1}{F1}=\frac{1}{2}(\frac{1}{P}+\frac{1}{R})$</li>
</ul>
</li>
</ul>
<h6 id="f_beta-度量">$F_{\beta}$ 度量</h6>
<ul>
<li>$F 1=\frac{(1+\beta^2) \times P \times R}{(\beta^2 \times P) + R}$</li>
<li>源于查准率与查全率的加权调和平均
<ul>
<li>$\frac{1}{F_{\beta}}=\frac{1}{1+\beta^2}(\frac{1}{P}+\frac{\beta^2}{R})$</li>
</ul>
</li>
<li>$\beta$ 度量了查全率和查准率的相对重要性
<ul>
<li>$\beta=1$退化为标准型$F1$值</li>
<li>$\beta&gt;1$时查全率有更大影响</li>
<li>$\beta&lt;1$时查准率有更大影响</li>
</ul>
</li>
</ul>
<h6 id="n次二分类实现的多分类问题">n次二分类实现的多分类问题</h6>
<ul>
<li>
<p>先分别计算，再求平均值</p>
<ul>
<li>宏查准率: macro-P = $\frac{1}{n}\sum_{i=1}^{n}P_{i}$</li>
<li>宏查全率: macro-R = $\frac{1}{n}\sum_{i=1}^{n}R_{i}$</li>
<li>宏F1: macro-F1 = $\frac{2 \times \text{macro-P} \times \text{macro-R}}{\text{macro-P + macro-R}}$</li>
</ul>
</li>
<li>
<p>先求平均值，再分别计算</p>
<ul>
<li>平均值分别记为：$\overline{TP}、\overline{FP}、\overline{TN}、\overline{FN}$</li>
<li>微查准率: $\text{micro-P}=\frac{\overline{TP}}{\overline{TP}+\overline{FP}}$</li>
<li>微查全率: $\text{micro-R}=\frac{\overline{TP}}{\overline{TP}+\overline{FN}}$</li>
<li>微F1: $\text{micro-F1}=\frac{2 \times \text{micro-P} \times \text{micro-R}}{\text{micro-P}+\text{micro-R}}$</li>
</ul>
</li>
</ul>
<h3 id="roc与auc">ROC与AUC</h3>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/27/2392c3cd2511259a0c3d51da97ba8f1e.webp" alt=""></p>
<p>纵轴是“真正例率”（True Positive Rate，简称TPR），横轴是“假正例率”（False Positive Rate，简称FPR）</p>
<h5 id="rocreceiver-operating-characteristic">ROC（Receiver Operating Characteristic）</h5>
<p>“受试者工作特征”曲线</p>
<ul>
<li>$TPR=\frac{TP}{TP+FN}$</li>
<li>$FPR=\frac{FP}{TN+FP}$</li>
</ul>
<h5 id="aucarea-under-roc-curve">AUC（Area Under ROC Curve）</h5>
<p>ROC曲线下的面积</p>
<blockquote>
<p>$AUC=\frac{1}{2}\sum_{i=1}^{m-1}(x_{i+1}-x_i)(y_i+y_{i+1})$</p>
</blockquote>
<blockquote>
<p>AUC是考虑样本预测的排序质量，因此它与排序误差有紧密联系</p>
</blockquote>
<p>排序导致的损失公式</p>
<!-- raw HTML omitted -->
<p>考虑每一个正反例，如果预测值小于反例，记1，若相等，记0.5</p>
<p>$AUC = 1 - \ell_{rank}$</p>
<h3 id="代价敏感错误率与代价曲线">代价敏感错误率与代价曲线</h3>
<p>非均等代价（unequal cost）</p>
<blockquote>
<p>为权衡不同类型错误所造成的不同损失</p>
</blockquote>
<h4 id="代价矩阵cost-matrix">代价矩阵（cost matrix）</h4>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/27/33b14d6c21a3fb27bde09b555c8315cd.webp" alt="代价矩阵"></p>
<ul>
<li>$cost_{ij}$表示将第i类样本预测为第j类样本的代价</li>
<li>一般来说，$cost_{ij}=0$</li>
<li>若将第0类判别为第1类所造成的损失更大，则$cost_{01} &gt; cost_{10}$</li>
<li>损失程度相差越大，$cost_{01}$与$cost_{10}$值的差别越大</li>
</ul>
<p><strong>在非均等代价下，我们所希望的不再是简单地最小化错误次数，而是希望最小化“总体代价”（total cost）</strong></p>
<blockquote>
<p>代价敏感（cost-sensitive）错误率公式:</p>
</blockquote>
<blockquote>
<p>$E(f;D;cost)=\frac{1}{m}(\sum_{\boldsymbol{x_i} \in D^+}\mathbb{I}(f(\boldsymbol{x_i}) \neq y_i) \times cost_{01} + \sum_{\boldsymbol{x_i} \in D^-}\mathbb{I}(f(\boldsymbol{x_i}) \neq y_i) \times cost_{10})$</p>
</blockquote>
<h4 id="代价曲线cost-curve">代价曲线（cost curve）</h4>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/27/71912943c2a82961e4ae632219facbb9.webp" alt="代价曲线"></p>
<p>$p=\frac{m^+}{m};m是样例数，m^+是正样例数$</p>
<p>横轴</p>
<ul>
<li>取值为 [0, 1] 的正例概率代价</li>
<li>$P(+)cost=\frac{p \times cost_{01}}{p \times cost_{01} + (1 - p) \times cost_{10}}$</li>
</ul>
<p>纵轴</p>
<ul>
<li>取值为 [0, 1] 的归一化代价</li>
<li>$cost_{norm}=\frac{FNR \times p \times cost_{01} + FPR \times (1-p) \times cost_{10}}{p \times cost_{01} + (1-p) \times cost_{10}}$</li>
</ul>
<p>当判断阈值threshold一定时，就确定了一组相应的混淆矩阵，而根据样例中的正样例数量的比率的不同，产生了不同的代价期望</p>
<p><strong>在非均等代价下，ROC曲线不能直接反映出学习器的期望总体代价</strong></p>
<blockquote>
<p><strong>目的：根据正例在样本中的比值的不同，找到使得代价总期望最小的模型的阈值</strong></p>
</blockquote>
<h2 id="24-比较检验">2.4 比较检验</h2>
<h3 id="问题">问题</h3>
<p>1、测试集上的性能与真实的泛化性能未必相同</p>
<p>2、测试集的不同反映出来的性能不同</p>
<p>3、机器学习算法本身有一定的随机性，同一测试集上的性能也不同</p>
<h3 id="测试错误率与泛化错误率未必相同但二者理论上相近">测试错误率与泛化错误率未必相同，但二者理论上相近</h3>
<h4 id="真实情况下">真实情况下：</h4>
<p>泛化错误率为 $\epsilon$ 的学习器在一个样本上犯错的概率是 $\epsilon$</p>
<h4 id="统计情况下">统计情况下：</h4>
<p>测试错误率 $\hat\epsilon$ 意味着在 $m$ 个测试样本中恰有 $\hat\epsilon \times m$ 个被误分类</p>
<h3 id="统计假设检验hypothesis-test">统计假设检验（hypothesis test）</h3>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/27/81bd832da517ee7dd8bd106f7ba75f12.webp" alt=""></p>
<p>若在测试集上观察到学习器A比学习器B好，则A的泛化性能是否在统计意义上优于B，以及这个结论的把握有多大</p>
<p><a href="https://www.zhihu.com/question/287895170">参考知乎答案</a></p>
<h5 id="符号">符号</h5>
<ul>
<li>$\epsilon$ - 泛化错误率
<blockquote>
<p>是学习器的内在属性，是客观存在的值，但是无法观测</p>
</blockquote>
</li>
<li>$\epsilon_{0}$ - 泛化错误率
<blockquote>
<p>是人为设定的一个值，用于推测真实的泛化错误率</p>
</blockquote>
<ul>
<li>$\epsilon = \epsilon_{0}$</li>
<li>$\epsilon \le \epsilon_{0}$</li>
<li>$\epsilon \ge \epsilon_{0}$</li>
</ul>
</li>
<li>$\hat {\epsilon}$ - 测试错误率
<blockquote>
<p>是经过实验观测到的测试错误率，跟泛化错误率存在某种关系</p>
</blockquote>
</li>
<li>$\overline{\epsilon}$ - 检验临界值
<blockquote>
<p>是测试错误率的上限，为了使得假设条件得到满足的最大测试错误率的值</p>
</blockquote>
</li>
</ul>
<h5 id="理念">理念</h5>
<p>假设测试样本是从样本总体分布中独立采样而得，且学习器的泛化错误率为$\epsilon$</p>
<p>在$m$个样本中，有$m'$个样本被误分类，其余样本全部正确分类的概率是:</p>
<p>$$\begin{pmatrix} m \\ m' \end{pmatrix}\epsilon^{m'}(1-\epsilon)^{m-m'}$$</p>
<p>由此可估算出其恰将$\hat \epsilon \times m$ 个样本误分类的概率是：</p>
<p>$$P(\hat{\epsilon};\epsilon)=\begin{pmatrix} m \\ \hat{\epsilon} \times m \end{pmatrix}\epsilon^{\hat{\epsilon} \times m}(1-\epsilon)^{m-\hat{\epsilon}\times m}$$</p>
<h5 id="常用方法">常用方法</h5>
<h6 id="t---检验t-test">t - 检验（t-test)</h6>
<p>存在k个测试错误率，$\hat{\epsilon_{1}}，\hat{\epsilon_{2}}，&hellip;，\hat{\epsilon_{k}}$</p>
<ul>
<li>平均测试错误率: $\mu = \frac {1} {k} \sum_{i=1}^k \hat{\epsilon_{i}}$</li>
<li>方差: $\sigma^2=\frac{1}{k-1}\sum_{i=1}^k(\hat{\epsilon_{i}}-\mu)^2$</li>
</ul>
<p><strong>$k$个测试错误率可以看作泛化错误率 $\epsilon$ 的独立采样</strong>
即：</p>
<ul>
<li>服从自由度为 $k-1$ 的 t-分布</li>
<li>$\tau_{t}=\frac{\sqrt{k}(\mu-\epsilon_{0})}{\sigma}$</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/27/c13c3c445822b36ade8566520f42e26a.webp" alt="t-分布"></p>
<blockquote>
<p>用于根据小样本来估计呈正态分布且方差未知的总体的均值
自由度越小，曲线越平坦，自由度越大，越接近标准正态分布
其本质是一族曲线，每一个自由度的值都可以确定其中唯一一条曲线</p>
</blockquote>
<ul>
<li>
<p>双边检验的临界值: $t_{\frac{\alpha}{2},k-1}$</p>
</li>
<li>
<p>结论</p>
</li>
<li>
<p>当 $\tau_{t} \le t_{\frac{\alpha}{2},k-1}$ 则假设不能被拒绝，即认为两个学习器的性能没有显著差别</p>
</li>
<li>
<p>当 $\tau_{t} &gt; t_{\frac{\alpha}{2},k-1}$ 则假设被拒绝，且平均错误率较小的那个学习器性能更优</p>
</li>
</ul>
<h6 id="交叉验证-t-检验">交叉验证 t 检验</h6>
<p>若两个学习期的性能相同，则它们使用相同的训练集和测试集得到的测试错误率应相同，即：$\epsilon_{i}^A = \epsilon_{i}^B$</p>
<p><strong>k折交叉验证法</strong></p>
<p>步骤</p>
<ul>
<li>$Step1:$分别得到一组成对测试错误率$\epsilon_{1}^A，\epsilon_{2}^B，……，\epsilon_{k}^A$和$\epsilon_{1}^B，\epsilon_{2}^B，……，\epsilon_{k}^B$</li>
<li>$Step2:$对每对结果求查：$\Delta_{i}=\epsilon_{i}^A-\epsilon_{i}^B$，形成一组差值集合 $\Delta_{1}、\Delta_{2}、……、\Delta_{k}$</li>
<li>$Step3:$使用Step2中的差值集合来对“学习器A与学习器B性能相同”这个假设做t-检验</li>
<li>$Step4:$计算出差值的均值 $\mu$ 和 方差 $\sigma^2$，在显著度 $\alpha$ 下，计算变量 $$\tau_t =|\frac{\sqrt{k}\mu}{\sigma}|$$</li>
</ul>
<p><strong>5x2交叉验证法 (5次2折交叉验证)</strong></p>
<blockquote>
<p>为了缓解k折交叉验证法过高估计假设成立提出的解决方案</p>
</blockquote>
<p>步骤</p>
<ul>
<li>$Step1:$在每次进行2折交叉验证之前随机将数据打乱，使得五次交叉验证中的数据划分不重复</li>
<li>$Step2:$对两个学习器A和B，第i次2折交叉验证将产生两对测试错误率，分别对其求差 $$\Delta_{i}^{1} = \epsilon_{i}^{A_1}-\epsilon_{i}^{B_1}，\Delta_{i}^{2} = \epsilon_{i}^{A_2}-\epsilon_{i}^{B_2}$$</li>
<li>$Step3:$为了缓解测试错误率的非独立性，仅计算第1次2折交叉验证的结果平均值 $\mu = \frac{(\Delta_1^1+\Delta_1^2)}{2}$，但对每次2折实验的结果都计算出其方差 $$\sigma^2=(\Delta_i^1-\frac{\Delta_i^1+\Delta_i^2}{2})^2+(\Delta_i^2-\frac{\Delta_i^1+\Delta_i^2}{2})^2$$</li>
<li>$Step4:$计算变量 $$\tau_t = \frac{\mu}{\sqrt{\frac{\sum_{i=1}^5\sigma_{i}^2}{5}}}$$</li>
</ul>
<h6 id="mcnemar-检验">McNemar 检验</h6>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/27/18843556256b268a9b3a86251eb2b79d.webp" alt="列联表"></p>
<ul>
<li>
<p>列联表（contingency table）</p>
<ul>
<li>通常情况下，变量 $|e_{01}-e_{10}|$ 应当服从正态分布</li>
<li>特殊情况下，如果两个学习器性能相同，那么 $e_{01} = e_{10}$</li>
</ul>
</li>
<li>
<p>计算变量 $$\tau_{\chi^2} = \frac{(|e_{01} - e_{10}| - 1)^2}{e_{01} - e_{10}}$$</p>
<ul>
<li>服从自由度为1的卡方分布，即标准正态分布变量的平方</li>
<li>如果通过卡方分布进行评估，则通过将上表的$e_{01}$与$e_{10}$两个频率中较小的一个加上0.5、较大的一个减去0.5来进行连续性校正。这种纠正在统一降低差异的绝对值$e_{01}-e_{10}$中具有明显的效果。提出后为式子 -1</li>
<li>最终结论看平均错误率较小的学习器性能更优</li>
</ul>
</li>
</ul>
<h6 id="friedman-检验">Friedman 检验</h6>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/27/564866fcd635d7047949c1250d5e81d5.webp" alt="算法比较序值表"></p>
<p>步骤</p>
<ul>
<li>$Step1:$假设四个数据集 $D_{1}，D_{2}，D_{3}，D_{4}$，分别对A、B、C算法进行测试</li>
<li>$Step2:$在每个数据集上对测试性能好坏进行排序，并赋予序值，如果相同，则平均序值</li>
<li>$Step3:$对每一个算法在不同数据集上的序值进行求平均，得到平均序值</li>
<li>$Step4:$然后使用Friedman检验判断这些算法性能是否相同</li>
</ul>
<h6 id="nemenyi-后续检验nemenyi-post-hoc-test">Nemenyi 后续检验（Nemenyi post-hoc test）</h6>
<ul>
<li>计算平均序值差别的临界值域</li>
<li>$CD=q_{\alpha}\sqrt{\frac{k(k+1)}{6N}}$
<blockquote>
<p>$q_{\alpha}$是Tukey分布的临界值</p>
</blockquote>
</li>
<li>若两个算分的平均序值之差超过了临界值域，则以相应的置信度拒绝“两个算法性能相同”这一假设</li>
</ul>
<h6 id="friedman-检验图">Friedman 检验图</h6>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/27/ec3516e38cc200140dccb875e9dbc212.webp" alt="Friedman 检验图"></p>
<ul>
<li>纵轴是各个算法，横轴是平均序值</li>
<li>每个算法以原点显示其平均序值，然后线段的长度描述临界值域的大小</li>
<li>若线段重叠，则说明算法之间没有显著性能差别，否则即说有显著性能差别</li>
</ul>
<h2 id="25-偏差与方差">2.5 偏差与方差</h2>
<p>&ldquo;偏差-方差分解&rdquo;（bias-variance decomposition）用来解释其学习器为什么具备这样的性能</p>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/10/27/a9ba3cf025e59fa6cd4834ccc3b9afab.webp" alt="偏差-方差分解"></p>
<h3 id="对于测试样本boldsymbolx">对于测试样本$\boldsymbol{x}$</h3>
<h5 id="符号说明">符号说明</h5>
<ul>
<li>$y$ 为样本的真实标记</li>
<li>$y_{D}$ 为样本在数据集中的标记</li>
<li>$f(\boldsymbol{x};D)$ 为学习器输出的样本标记</li>
</ul>
<h5 id="偏差-方差分解公式">偏差-方差分解公式</h5>
<p><strong>$E(f;D)=bias^2(\boldsymbol{x})+var(\boldsymbol{x})+\varepsilon^2$</strong></p>
<ul>
<li>学习算法的期望预测: $$\overline{f}(\boldsymbol{x})=\mathbb{E}_{D}[f(\boldsymbol{x};D)]$$</li>
<li>使用样本数相同的不同训练集产生的方差: $$var(\boldsymbol{x})=\mathbb{E}_{D}[(f(\boldsymbol{x};D)-\overline{f}(\boldsymbol{x}))^2]$$</li>
<li>噪声: $$\varepsilon^2=\mathbb{E}_D[(y_D-y)^2]$$</li>
<li>偏差: $$bias^2(\boldsymbol{x})=(\overline{f}(\boldsymbol{x})-y)^2$$</li>
</ul>
<h5 id="结论">结论</h5>
<ul>
<li>偏差：度量了学习算法的期望预测与真实结果的偏离程度，即刻画了学习算法本身的拟合能力</li>
<li>方差：度量了同样大小的训练集的变动所导致的学习性能的变化，即刻画了数据扰动所造成的影响</li>
<li>噪声：表达了在当前任务上任何学习算法所能达到的期望泛化误差的下界，即刻画了学习问题本身的难度</li>
</ul>
<p><strong>泛化性能是由学习算法的能力、数据的充分性以及学习任务本身的难度所共同决定的</strong></p>
<ul>
<li>使得偏差较小，即能充分拟合数据</li>
<li>使得方差较小，即使得数据扰动产生的影响小</li>
</ul>
<hr>
<blockquote>
<p>以上内容也可以到我的 Github 去查看(附了相应实现代码哟)  <a href="https://github.com/Ryuchen/Machine-Learning-Notes">Machine-Learning-Notes</a></p>
</blockquote>

<section class="attachments grey">
	<label>
		<span>
			<i class="fa fa-paperclip"></i>
		</span>
		笔记内容（XMind、Markdown、PNG）
	</label>
	
		
	
	<div class="attachments-files">
	
		
		
			<li>
				<a href="/posts/0x000018.files/%e7%ac%ac%e4%ba%8c%e7%ab%a0%20%e6%a8%a1%e5%9e%8b%e8%af%84%e4%bc%b0%e4%b8%8e%e9%80%89%e6%8b%a9.png" >
					第二章 模型评估与选择.png
				</a>
				(5917 kb)
			</li>
		
	
		
		
			<li>
				<a href="/posts/0x000018.files/%e7%ac%ac%e4%ba%8c%e7%ab%a0%20%e6%a8%a1%e5%9e%8b%e8%af%84%e4%bc%b0%e4%b8%8e%e9%80%89%e6%8b%a9.xmind" >
					第二章 模型评估与选择.xmind
				</a>
				(2879 kb)
			</li>
		
	
	<div>
	
</section>

                        </div><div class="tags my-3"><a class="badge badge-pill badge-light border mr-2" href="/tags/%E5%91%A8%E5%BF%97%E5%8D%8E/">
                                    <i class="fas fa-tag mr-2"></i>周志华
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/%E6%A8%A1%E5%9E%8B%E8%AF%84%E4%BC%B0%E4%B8%8E%E9%80%89%E6%8B%A9/">
                                    <i class="fas fa-tag mr-2"></i>模型评估与选择
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/%E8%A5%BF%E7%93%9C%E4%B9%A6/">
                                    <i class="fas fa-tag mr-2"></i>西瓜书
                                </a></div><div style="text-align: center;">
                            <div class="social-share" data-sites="wechat,weibo,twitter,facebook,douban" data-mobile-sites="wechat,weibo"></div>
                        </div>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        

<div id="comments-gittalk"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script> 
    <script>
    var gittalk = new Gitalk({
        id: '0x000018',
        owner: 'Ryuchen',
        repo: 'ryuchen.github.io',
        admin: ['Ryuchen'],
        clientID: 'cda75f43f62ef6ebc3ea',
        clientSecret: 'e405fb603c664a6436a481917a7ee70931413268',
    })
    gittalk.render('comments-gittalk')
    </script>



                    </div>
                </div>
            </article>
        </div>
    </div>

    <div class="related-content row mt-5 row-cols-1 row-cols-lg-3"><div class="col mb-3">
                <div class="card h-100 shadow">
    
    <a href="/posts/0x000017/" class="d-block">
                        <img data-src="https://cdn.jsdelivr.net/gh/Ryuchen/ryuchen.github.io@master/images/machine-learning_huda146d3825fc6d502e05b38609bff098_23368_700x350_resize_q75_box.jpg" class="card-img-top mx-auto d-block" alt="[读书笔记]《西瓜书》第一章 绪论">
                    <div class="card-body">
            <div class="card-title">
                [读书笔记]《西瓜书》第一章 绪论
            </div><div class="card-serie"><span class="badge badge-pill badge-primary">机器学习</span> &nbsp;</div><p class="card-text text-muted text-uppercase">October 26, 2020</p>
            <div class="card-text">
                周志华《机器学习》俗称西瓜书，自己的读书笔记 Chapter: 1.绪论
            </div>
        </div>
    </a>
</div>

            </div></div>
</main>

        <footer class="footer bg-dark py-6">
    <div class="container">
        <div class="row">
            <div class="col-sm text-center">
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="https://ryuchen.club/index.xml" rel="alternate" type="application/rss+xml" class="icons d-block">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a></li><li class="list-inline-item">
                        <a href="mailto:chenhaom1993@hotmail.com" class="icons d-block">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li><li class="list-inline-item">
                            <a href="https://github.com/Ryuchen" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://weibo.com/u/3147247770" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-weibo fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                </ul>

                <p class="text-muted">
                    
                        Copyright © 2018–2020, WangOO and Ryuchen, all rights reserved.
                    
                </p>

                <p class="text-muted">
                    京ICP备2020040667号
                </p>

                <p class="text-muted">
                    本站总记被访问 <span id="busuanzi_value_site_pv"></span> 次， 
                    您是第 <span id="busuanzi_value_site_uv"></span> 个来访小伙伴。
                </p>
            </div>
            <div class="col-sm text-center"><p class="text-muted">维护不易，渴望您的资助</p><ul class="list-inline">
                    <div class="row">
                        <div class="col-sm text-center"><li class="list-inline-item">
                                <img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@sponsor/wechat.jpg" alt="WechatPay" class="loaded" data-was-processed="true" style="width: 140px;padding: 4px">
                            </li></div>
                        <div class="col-sm text-center"><li class="list-inline-item">
                                <img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@sponsor/alipay.jpg" alt="AliPay" class="loaded" data-was-processed="true" style="width: 140px;padding: 4px">
                            </li></div>
                    </div>
                </ul>
            </div>
        </div>
    </div>
    <div class="netease-music">
            <audio id="music-player" crossorigin playsinline>
            </audio>
        </div>
    
</footer>

        
    
        
            <script src='/dist/main.bf9558b8596b4accd07a.min.js'></script>
        
    



<script src='https://cdn.jsdelivr.net/gh/Ryuchen/ryuchen.github.io@master//mermaid/mermaid.js'></script>



    <script>
        window.Prism = window.Prism || {};
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/autoloader/prism-autoloader.min.js"></script>




    <script>
  MathJax = {
    tex: {
      inlineMath: [["$", "$"]],
    },
    displayMath: [
      ["$$", "$$"],
      ["\[\[", "\]\]"],
    ],
    svg: {
      fontCache: "global",
    },
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>


<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https'){
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else{
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>


<script>
    (function(){
    var el = document.createElement("script");
    el.src = "https://s3a.pstatp.com/toutiao/push.js?1b349c44e658214c68be3a649c8dd67d03df3ccff5cf4d26c95620535e04d891417631efa03c64873bef9496a5c9bb7c62f7c4af6b1a55b161baff8a0b4e2fba";
    el.id = "ttzz";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(el, s);
    })(window)
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"  crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js" integrity="sha256-fGPu+icKh985TLPhO2v68U7i0CW0dE4kiR06RN4O6jo=" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-0EFH27TG1R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-0EFH27TG1R');
</script>
    </body>
</html>
