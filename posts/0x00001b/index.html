<!DOCTYPE html>
<html lang='zh'>
    <head>
        <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">
<title>
  
     [读书笔记]《西瓜书》第三章 线性模型 补充 |  Sweet House
  
</title>


  <meta name="description" content="Everyday is a holiday">


<meta name="bytedance-verification-code" content="MmXZwSvr8lAvM1hIXSkm" />

<meta name="author" content='[Ryuchen WangOO]'>

<link rel="icon" href='/favicon.ico'>


  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/themes/prism-dark.min.css">
  



  
      
        <link rel="stylesheet" href='/dist/main.4707e15c5ca4eab5da71.min.css'>
      
  


<link rel="stylesheet" href='/css/shortcodes.css'>

<link rel="canonical" href="https://ryuchen.club/posts/0x00001b/"><meta property="og:title" content="[读书笔记]《西瓜书》第三章 线性模型 补充" />
<meta property="og:description" content="周志华《机器学习》俗称西瓜书，自己的读书笔记 Chapter: 3.线性模型 补充" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ryuchen.club/posts/0x00001b/" />
<meta property="og:image" content="https://ryuchen.club/machine-learning.jpg" />
<meta property="article:published_time" content="2020-11-05T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-11-05T00:00:00+00:00" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000032/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000031/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x000030/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x00002e/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x00002d/" /><meta property="og:see_also" content="https://ryuchen.club/posts/0x00002c/" />

<meta itemprop="name" content="[读书笔记]《西瓜书》第三章 线性模型 补充">
<meta itemprop="description" content="周志华《机器学习》俗称西瓜书，自己的读书笔记 Chapter: 3.线性模型 补充">
<meta itemprop="datePublished" content="2020-11-05T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-11-05T00:00:00+00:00" />
<meta itemprop="wordCount" content="231">
<meta itemprop="image" content="https://ryuchen.club/machine-learning.jpg">



<meta itemprop="keywords" content="周志华,线性模型,西瓜书," />

    </head>
    <body>
        
<nav class="navbar navbar-expand-md navbar-light bg-light fixed-top shadow-sm" id="navbar-main-menu">
    <div class="container">
        <a class="navbar-brand font-weight-bold" href="https://ryuchen.club"> >$ cd /home_</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#main-menu" aria-controls="main-menu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="main-menu">
            <ul class="navbar-nav ml-auto">
                    
                        <li class='nav-item'><a class="nav-link" href="/">首页</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/posts/">博文</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/projects/">项目</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/snippet/">代码</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/essay/">随笔</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/gallery/">照片墙</a></li>
                    
                        <li class='nav-item'><a class="nav-link" href="/about/">关于</a></li>
                    
                
                <li class="nav-item"><a class="nav-link" href="https://github.com/Ryuchen" target="_blank">Github</a></li>
            </ul>
        </div>
    </div>
</nav>

        
<main class="content-page container pt-7 pb-5">
    
    <div class="row">
        <div class="col">
            <article>
                <div class="row justify-content-center">
                    <div class="col-lg-10">
                        <h1>[读书笔记]《西瓜书》第三章 线性模型 补充</h1>
                        <div class="meta text-muted mb-3" style="text-align: right;">
                            
                            <p class="created text-muted text-uppercase font-weight-bold mb-1">November 5, 2020</p>
                            <span class="mr-2"><i class="fas fa-book-open mr-2"></i>1850</span>
                            <span><i class="fas fa-clock mr-2"></i>8 minutes and
                                24 seconds</span>
                        </div>
                        <div class="category my-3"><a class="badge badge-pill badge-light border mr-2" href="/categories/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0">
                                    <i class="fas fa-tag mr-2"></i>机器学习
                                </a></div></div>
                </div><div class="row justify-content-center mb-3">
                                <div class="col-lg-10">
                                    <img data-src="/images/machine-learning_huda146d3825fc6d502e05b38609bff098_23368_900x500_fit_q75_box.jpg" class="img-fluid rounded mx-auto d-block" alt="[读书笔记]《西瓜书》第三章 线性模型 补充">
                                </div>
                            </div><div class="row justify-content-center">
                    <div class="col-lg-10">
                        <div class="content">
                            <h2 id="第三章-线性模型-补充">第三章 线性模型 补充</h2>
<hr>
<h2 id="前提假设">前提假设</h2>
<blockquote>
<p>引用知乎答案：<a href="https://www.zhihu.com/question/26901024/answer/153814845">回归最基本的前提假设是什么？</a></p>
</blockquote>
<p>There are <!-- raw HTML omitted --><strong>four principal assumptions</strong><!-- raw HTML omitted --> which justify the use of linear regression models for purposes of inference or prediction:</p>
<ul>
<li>linearity and additivity of the relationship between dependent and independent variables:
<ul>
<li>(a) The expected value of dependent variable is a straight-line function of each independent variable, holding the others fixed.</li>
<li>(b) The slope of that line does not depend on the values of the other variables.</li>
<li>(c) The effects of different independent variables on the expected value of the dependent variable are additive.</li>
</ul>
</li>
<li>statistical independence of the errors (in particular, no correlation between consecutive errors in the case of time series data)</li>
<li>homoscedasticity (constant variance) of the errors
<ul>
<li>(a) versus time (in the case of time series data)</li>
<li>(b) versus the predictions</li>
<li>(c) versus any independent variable</li>
</ul>
</li>
<li>normality of the error distribution.</li>
</ul>
<hr>
<p>个人对上面的翻译：</p>
<p>在使用线性回归模型用来做推断和预测的时候，需要建立在四个假设的基础上是合理的：</p>
<ul>
<li>因变量和自变量之间关系存在线性的关系且具有可加性
<ul>
<li>当其他自变量不变时，因变量的期望值可以通过任一自变量的一条直线函数得到</li>
<li>该线的斜率不取决于其他因变量的值</li>
<li>不同自变量对因变量期望值的影响是累加的</li>
</ul>
</li>
<li>误差的统计独立性（特别是在时间序列数据的情况下，连续错误之间没有相关性）</li>
<li>误差之间是的同方差（恒定方差）
<ul>
<li>与时间之间（对于时间序列数据）</li>
<li>与预测值之间</li>
<li>与任一因变量之间</li>
</ul>
</li>
<li>误差是呈现正态分布的</li>
</ul>
<blockquote>
<p>总结一下，即：线性回归是建立在承认数据集存在噪音的基础之上的，而且这些噪声本身是属于同一方差和均值下的正态分布中的样本，换句话说，即假设这些噪声是独立同分布的从一个均值为$\mu$方差为$\sigma$的正态分布中取出的。</p>
</blockquote>
<h2 id="最小二乘法最小平方法">最小二乘法（最小平方法）</h2>
<blockquote>
<p>引用B站大神shuhuai008视频：<a href="https://www.bilibili.com/video/BV1aE411o7qd/?p=9">白板推导系列：线性回归-最小二乘法</a></p>
</blockquote>
<blockquote>
<p>这里吐槽一下：我个人觉得最小二乘法这个名称特别难记，还不如最小平方法来的实际</p>
</blockquote>
<h3 id="标准定义">标准定义</h3>
<p>最小二乘法，又称最小平方法，是一种数学优化建模方法。它通过最小化误差的平方和寻找数据的最佳函数匹配。 利用最小二乘法可以简便的求得未知的数据，并使得求得的数据与实际数据之间误差的平方和为最小。 “最小二乘法”是对线性方程组，即方程个数比未知数更多的方程组，以回归分析求得近似解的标准方法。</p>
<p>视频中讲解了如何用最小二乘法来进行估计线性回归的闭式解，并且从几何视角和概率视角进行了讲解，相比西瓜书来说要容易理解的多。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/11/05/d414df5fa064894f52f874b2a28911a7.webp" alt=""></p>
<p><strong>样本集的特征构成了一个 $p$ 维的空间，而 $y$ 向量独立于这个空间，目的即为找到一条直线离这个 $y$ 向量最近</strong></p>
<div class="bilibili-embed">
    <div>
        <iframe src="//player.bilibili.com/player.html?aid=70839977&amp;bvid=BV1aE411o7qd&amp;cid=123440295&amp;page=9&as_wide=1&high_quality=1&danmaku=0" scrolling="no" framespacing="0" allowfullscreen="true"></iframe>
    </div>
</div>
<!-- raw HTML omitted -->
<p><strong>这里前者可以看做将原来的总噪声分布在每个样本之上的，后者则可以看做将原来的总噪声分布在每个特征之上</strong></p>
<blockquote>
<p>上面就是我看过视频觉得最有启发的两个点</p>
</blockquote>
<h2 id="lasso和ridge">Lasso和Ridge</h2>
<p>首先要明确的一个问题是标准线性回归的公式最终求解的公式为 $\boldsymbol{w}=(X^{T}X)^{-1}X^{T}\boldsymbol{y}$ 中可以看出在计算回归系数的时候我们需要计算矩阵 $X^{T}X$ 的逆，但是如果该矩阵是个奇异矩阵，则无法对其进行求解。</p>
<blockquote>
<p>那么什么情况下该矩阵会有奇异性呢?</p>
</blockquote>
<ul>
<li>
<p>$X$ 本身存在线性相关关系(多重共线性)，即非满秩矩阵。</p>
<blockquote>
<p>如果数据的特征中存在两个相关的变量，即使并不是完全线性相关，但是也会造成矩阵求逆的时候造成求解不稳定。</p>
</blockquote>
</li>
<li>
<p>当数据特征比数据量还要多的时候，这时候矩阵是一个矮胖型的矩阵，也是非满秩的矩阵。</p>
</li>
</ul>
<h3 id="lasso和ridge在损失函数">Lasso和Ridge在损失函数</h3>
<blockquote>
<p>二者的共同目的都是为了将回归系数 $\boldsymbol{w}$ 收缩到一定的区域内，防止模型的过拟合</p>
</blockquote>
<h4 id="lasso">Lasso</h4>
<p>Lasso的主要思想是构造一个一阶惩罚函数，来得到一个防止过拟合的模型。</p>
<p>本质为:</p>
<!-- raw HTML omitted -->
<p>以两个变量为例，标准线性回归的loss function还是可以用二维平面的等值线表示，Lasso的约束条件可以用方形表示，如下图:</p>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/11/05/6ecafae0904df6a783bd2e64d6b6ae64.webp" alt=""></p>
<p>当方形的顶点与抛物面相交时，其切点在坐标轴上的概率更大，因此其对应的权重变为0</p>
<p>其本身特点有：</p>
<ul>
<li>Lasso 对于异常值不敏感</li>
<li>Lasso 可以将权重较小的值，置为0，因此可以用作特征选择</li>
<li>Lasso 可能存在多个最优解</li>
</ul>
<h4 id="ridge">Ridge</h4>
<p>Ridge的主要思想是构造一个二阶惩罚函数，来得到一个防止过拟合的模型。</p>
<p>本质为:</p>
<!-- raw HTML omitted -->
<p>以两个变量为例, 标准线性回归的loss function还是可以用二维平面的等值线表示。而Ridge限制条件相当于在二维平面的一个圆。如下图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/11/05/376542c586f0166a326175eed4de752a.webp" alt=""></p>
<p>这个时候等值线与圆相切的点便是在约束条件下的最优点，但通常情况下，其切点在坐标轴上的概率较小，因此其对应的权重很难变为0</p>
<p>其本身的特点有：</p>
<ul>
<li>Ridge 在计算过程中十分方便</li>
<li>Ridge 一定只有一条最好的预测线</li>
<li>Ridge 对于异常值要比 Lasso 敏感一点</li>
</ul>
<h4 id="对比">对比</h4>
<blockquote>
<p>这里详细的内容参见 知乎答案 <a href="https://www.zhihu.com/question/26485586/answer/616029832">L1正则与L2正则的特点是什么，各有什么优势？</a></p>
</blockquote>
<p>这里摘抄两个图粘贴在此，以作为方便记忆上面的Lasso和Ridge各自的特点</p>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/11/05/f92b6a9ee01d923cc9d7d86ed78f50b5.webp" alt=""></p>
<p>在梯度更新时，不管 L1 的大小是多少（只要不是0）梯度都是1或者-1，所以每次更新时，它都是稳步向0前进。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@develop/2020/11/05/6894f0a1c89a79ed0ba08bc0e5be3b76.webp" alt=""></p>
<p>而看 L2 的话，就会发现它的梯度会越靠近0，就变得越小。</p>
<p>也就是说加了 L1 正则的话基本上经过一定步数后很可能变为0，而 L2 几乎不可能，因为在值小的时候其梯度也会变小。于是也就造成了 L1 输出稀疏的特性。</p>
<hr>
<blockquote>
<p>以上内容也可以到我的 Github 去查看(附了相应实现代码哟)  <a href="https://github.com/Ryuchen/Machine-Learning-Notes">Machine-Learning-Notes</a></p>
</blockquote>

                        </div><div class="tags my-3"><a class="badge badge-pill badge-light border mr-2" href="/tags/%E5%91%A8%E5%BF%97%E5%8D%8E/">
                                    <i class="fas fa-tag mr-2"></i>周志华
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/%E7%BA%BF%E6%80%A7%E6%A8%A1%E5%9E%8B/">
                                    <i class="fas fa-tag mr-2"></i>线性模型
                                </a><a class="badge badge-pill badge-light border mr-2" href="/tags/%E8%A5%BF%E7%93%9C%E4%B9%A6/">
                                    <i class="fas fa-tag mr-2"></i>西瓜书
                                </a></div><div style="text-align: center;">
                            <div class="social-share" data-sites="wechat,weibo,twitter,facebook,douban" data-mobile-sites="wechat,weibo"></div>
                        </div>
                    </div>
                </div>

                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        

<div id="comments-gittalk"></div>
    <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
    <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script> 
    <script>
    var gittalk = new Gitalk({
        id: '0x00001b',
        owner: 'Ryuchen',
        repo: 'ryuchen.github.io',
        admin: ['Ryuchen'],
        clientID: 'cda75f43f62ef6ebc3ea',
        clientSecret: 'e405fb603c664a6436a481917a7ee70931413268',
    })
    gittalk.render('comments-gittalk')
    </script>



                    </div>
                </div>
            </article>
        </div>
    </div>

    <div class="related-content row mt-5 row-cols-1 row-cols-lg-3"><div class="col mb-3">
                <div class="card h-100 shadow">
    
    <a href="/posts/0x00001a/" class="d-block">
                        <img data-src="https://cdn.jsdelivr.net/gh/Ryuchen/ryuchen.github.io@master/images/machine-learning_huda146d3825fc6d502e05b38609bff098_23368_700x350_resize_q75_box.jpg" class="card-img-top mx-auto d-block" alt="[读书笔记]《西瓜书》第三章 线性模型">
                    <div class="card-body">
            <div class="card-title">
                [读书笔记]《西瓜书》第三章 线性模型
            </div><div class="card-serie"><span class="badge badge-pill badge-primary">机器学习</span> &nbsp;</div><p class="card-text text-muted text-uppercase">October 30, 2020</p>
            <div class="card-text">
                周志华《机器学习》俗称西瓜书，自己的读书笔记 Chapter: 3.线性模型
            </div>
        </div>
    </a>
</div>

            </div><div class="col mb-3">
                <div class="card h-100 shadow">
    
    <a href="/posts/0x000019/" class="d-block">
                        <img data-src="https://cdn.jsdelivr.net/gh/Ryuchen/ryuchen.github.io@master/images/machine-learning_huda146d3825fc6d502e05b38609bff098_23368_700x350_resize_q75_box.jpg" class="card-img-top mx-auto d-block" alt="[读书笔记]《西瓜书》第二章 模型评估与选择 补充">
                    <div class="card-body">
            <div class="card-title">
                [读书笔记]《西瓜书》第二章 模型评估与选择 补充
            </div><div class="card-serie"><span class="badge badge-pill badge-primary">机器学习</span> &nbsp;</div><p class="card-text text-muted text-uppercase">October 28, 2020</p>
            <div class="card-text">
                周志华《机器学习》俗称西瓜书，自己的读书笔记 Chapter: 2.模型评估与选择 的自己整理的补充内容
            </div>
        </div>
    </a>
</div>

            </div><div class="col mb-3">
                <div class="card h-100 shadow">
    
    <a href="/posts/0x000018/" class="d-block">
                        <img data-src="https://cdn.jsdelivr.net/gh/Ryuchen/ryuchen.github.io@master/images/machine-learning_huda146d3825fc6d502e05b38609bff098_23368_700x350_resize_q75_box.jpg" class="card-img-top mx-auto d-block" alt="[读书笔记]《西瓜书》第二章 模型评估与选择">
                    <div class="card-body">
            <div class="card-title">
                [读书笔记]《西瓜书》第二章 模型评估与选择
            </div><div class="card-serie"><span class="badge badge-pill badge-primary">机器学习</span> &nbsp;</div><p class="card-text text-muted text-uppercase">October 27, 2020</p>
            <div class="card-text">
                周志华《机器学习》俗称西瓜书，自己的读书笔记 Chapter: 2.模型评估与选择
            </div>
        </div>
    </a>
</div>

            </div></div>
</main>

        <footer class="footer bg-dark py-6">
    <div class="container">
        <div class="row">
            <div class="col-sm text-center">
                <ul class="list-inline">
                    <li class="list-inline-item"><a href="https://ryuchen.club/index.xml" rel="alternate" type="application/rss+xml" class="icons d-block">
                                    <span class="fa-stack fa-lg">
                                        <i class="fa fa-circle fa-stack-2x"></i>
                                        <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a></li><li class="list-inline-item">
                        <a href="mailto:chenhaom1993@hotmail.com" class="icons d-block">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li><li class="list-inline-item">
                            <a href="https://github.com/Ryuchen" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li><li class="list-inline-item">
                            <a href="https://weibo.com/u/3147247770" class="icons d-block">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-weibo fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                </ul>

                <p class="text-muted">
                    
                        Copyright © 2018–2020, WangOO and Ryuchen, all rights reserved.
                    
                </p>

                <p class="text-muted">
                    京ICP备2020040667号
                </p>

                <p class="text-muted">
                    本站总记被访问 <span id="busuanzi_value_site_pv"></span> 次， 
                    您是第 <span id="busuanzi_value_site_uv"></span> 个来访小伙伴。
                </p>
            </div>
            <div class="col-sm text-center"><p class="text-muted">维护不易，渴望您的资助</p><ul class="list-inline">
                    <div class="row">
                        <div class="col-sm text-center"><li class="list-inline-item">
                                <img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@sponsor/wechat.jpg" alt="WechatPay" class="loaded" data-was-processed="true" style="width: 140px;padding: 4px">
                            </li></div>
                        <div class="col-sm text-center"><li class="list-inline-item">
                                <img src="https://cdn.jsdelivr.net/gh/Ryuchen/ImageBed@sponsor/alipay.jpg" alt="AliPay" class="loaded" data-was-processed="true" style="width: 140px;padding: 4px">
                            </li></div>
                    </div>
                </ul>
            </div>
        </div>
    </div>
    <div class="netease-music">
            <audio id="music-player" crossorigin playsinline>
            </audio>
        </div>
    
</footer>

        
    
        
            <script src='/dist/main.bf9558b8596b4accd07a.min.js'></script>
        
    



<script src='https://cdn.jsdelivr.net/gh/Ryuchen/ryuchen.github.io@master//mermaid/mermaid.js'></script>



    <script>
        window.Prism = window.Prism || {};
    </script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.22.0/plugins/autoloader/prism-autoloader.min.js"></script>




    <script>
  MathJax = {
    tex: {
      inlineMath: [["$", "$"]],
    },
    displayMath: [
      ["$$", "$$"],
      ["\[\[", "\]\]"],
    ],
    svg: {
      fontCache: "global",
    },
  };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.1.2/es5/tex-mml-chtml.js"></script>


<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




    <script>
        (function(){
            var bp = document.createElement('script');
            var curProtocol = window.location.protocol.split(':')[0];
            if (curProtocol === 'https'){
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else{
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(bp, s);
        })();
    </script>


<script>
    (function(){
    var el = document.createElement("script");
    el.src = "https://s3a.pstatp.com/toutiao/push.js?1b349c44e658214c68be3a649c8dd67d03df3ccff5cf4d26c95620535e04d891417631efa03c64873bef9496a5c9bb7c62f7c4af6b1a55b161baff8a0b4e2fba";
    el.id = "ttzz";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(el, s);
    })(window)
</script>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/css/share.min.css"  crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/social-share.js/1.0.16/js/social-share.min.js" integrity="sha256-fGPu+icKh985TLPhO2v68U7i0CW0dE4kiR06RN4O6jo=" crossorigin="anonymous"></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-0EFH27TG1R"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-0EFH27TG1R');
</script>
    </body>
</html>
